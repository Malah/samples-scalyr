Copart_ASA

{
  // specify a time zone if the timestamps in your log are not in GMT
  // timezone: "GMT-0800"
  patterns: {
    tsPattern: "\\w{3} \\d{1,2} \\d{4} \\d{2}:\\d{2}:\\d{2}",
    ipv46: "((\\d{1,3}\\.){3}\\d{1,3}|([a-fA-F0-9]{1,4}:?)+)+",
    alphaOnly: "[a-zA-Z]+",
    fglPattern: "(faddr|gaddr|laddr)",
  },
  formats: [
    {
      format: "\\<\\d+\\>$timestamp=tsPattern$ $host$ .*"
    }, {
      format: ".* : %$event_id$: $satus$ $direction=alphaOnly$ $protocol=alphaOnly$ connection $connectionId=number$ for $src_intf$:$src_ip=ipv46$\/$src_port=number$ \\(.+\\) to $dest_intf$:$dst_ip=ipv46$\/$dst_port=number$ \\(.+\\)$$"
      halt: true
    }, {
      format: ".* : %$event_id$: $status$ $direction=alphaOnly$ $protocol=alphaOnly$ connection for faddr $faddrIP=ipv46$\/$faddrPort=number$ gaddr $gaddrIP=ipv46$\/$gaddrPort=number$ laddr $laddrIP=ipv46$\/$laddrPort$ type $typeId=number$ code $codeId=number$$$"
      halt: true
    }, {
      format: ".* : %$event_id$: $status$ $built_type$ $protocol=alphaOnly$ $NAT$ from $src_intf$:$src_ip=ipv46$\/$src_port=number$ to $dst_intf$:$dst_ip=ipv46$\/$dst_port=number$$$"
      halt: true
    }, {
      format: ".*,$CDN_IP=ipv46$,$VIP_IP=ipv46$,$FW_IP=ipv46$.*CDN_TO_RNO_PUBLIC_SUBNETS"
      halt: true
    }, {
      format: ".* : %$event_id$: $type$ $fw$ $status$ $protocol$ $src_intf$/$src_ip=ipv46$\\($src_port=number$\\) -> $dst_intf$\/$dst_ip=ipv46$$dst_port$ hit-cnt $hit-cnt=number$ $details$\\[$id$\\]",
      halt: true
    }, {
      format: ".* : %$event_id$: $status$ from $src_intf$/$src_port=number$ to $dst_intf$/$dst_port=number$ flags $flag$ on interface $intefarce$",
      halt: true
    }, {
      format: ".* : %$event_id$: $status$ from $src_intf$/$src_port=number$ to $dst_intf$/$dst_port=number$, $msg$",
      halt: true
    }, {
      format: ".* : %$event_id$: $msg$ src $src$:$src_ip=ipv46$ dst $dst$:$dst_ip=ipv46$ $type$ on $inteface$ interface.  Original IP payload:  $Original_IP_payload$",
      halt: true
    }, {
      format: ".* : %$event_id$: $msg$ from $src_intf$:$src_ip=ipv46$/$src_port=number$ to $dst_intf$:$dst_ip=ipv46$/$dst_port=number$ with $err_msg$",
      halt: true
    }, {
      format: ".* : %$event_id$: $in_use=number$ in use, $most_used=number$ most used",
      halt: true
    }, {
      format: ".* : %$event_id$: $status$ $protocol$, from laddr $laddr_ip=ipv46$ on interface $src_intf$ to $dst_ip=ipv46$: $msg$",
      halt: true
    }, {
      format: ".* : %$event_id$: $status$ for $protocol$ error message: icmp src $src_intf$:$src_ip=ipv46$.* dst $dst_intf$:$dst_ip=ipv46$ \\(type $type$\\).* payload: $payload$",
      halt: true
    }, {
      format: ".* : %$event_id$: $status$ from $src_intf$:$src_ip=ipv46$.* to $dst_intf$:$dst_ip=ipv46$",
      halt: true
    }, {
      format: ".* : %$event_id$: $status$ with client $src_intf$:$src_ip=ipv46$\/$src_port$ to $dst_ip=ipv46$\/$dst_port$",
      halt: true
    }, {
      format: ".* : %$event_id$: $status$ trust-point $trust_host$ for client $src_intf$:$src_ip=ipv46$\/$src_port$ to $dst_ip=ipv46$\/$dst_port$",
      halt: true
    }, {
      format: ".* : %$event_id$: $msg$ IP <$ip$> $status$",
      halt: true
    }, {
      format: ".* : %$event_id$: \\[$state$\\] $status$\\. $msg$",
      halt: true
    }, {
      format: ".* : %$event_id$: $status$ OUTSIDE:$src_intf=ipv46$\/$src_port=number$ to $dst_ip=ipv46$\/$dst_port=number$ $msg$",
      halt: true
    }, {
      id: "teardown_1",
      format: ".* : %$event_id$: Teardown $protocol=alphaOnly$ connection $connectionId=number$ for $src_host$:$src_ip=ipv46$\/$src_port=number$ to $dst_host$:$dst_ip=ipv46$\/$dst_port=number$ $_=alphaOnly$ $_$ $_=alphaOnly$ $_$$$"
      halt: true
    }
  ]
}


/*

<166>Oct 18 2022 14:01:57 RNODCFWL01A-PROD : %ASA-6-302013: Built inbound TCP connection 711031808 for RNODCFWL01_PROD_OUTSIDE:10.151.54.35/36665 (10.151.54.35/36665) to RNODCFWL01_PROD_INSIDE:10.141.54.59/6003 (10.141.54.59/6003)

<166>Oct 18 2022 14:03:48 RNODCFWL01A-PROD : %ASA-6-302015: Built outbound UDP connection 712485829 for RNODCFWL01_PROD_OUTSIDE:10.143.30.32/53 (10.143.30.32/53) to RNODCFWL01_PROD_APP_DMZ:10.141.18.44/58076 (10.141.18.44/58076)

<166>Oct 18 2022 14:06:21 RNODCFWL01A-PROD : %ASA-6-302020: Built inbound ICMP connection for faddr 10.144.66.211/63417 gaddr 10.141.18.89/0 laddr 10.141.18.89/0 type 8 code 0

<166>Oct 18 2022 14:08:08 RNODCFWL01A-PROD : %ASA-6-305011: Built dynamic TCP translation from RNODCFWL01_PROD_INSIDE:10.141.8.61/43812 to RNODCFWL01_PROD_OUTSIDE:199.85.78.192/43812

<166>Oct 18 2022 14:05:11 RNODCFWL01A-PROD : %ASA-6-106100: access-list RNODCFWL01_PROD_APP_DMZ_ACCESS permitted tcp RNODCFWL01_PROD_APP_DMZ/10.141.18.105(6002) -> RNODCFWL01_PROD_INSIDE/10.149.216.147(3000) hit-cnt 1 first hit [0x28963b44, 0x7162c505]

<166>Oct 18 2022 14:07:28 RNODCFWL01A-PROD : %ASA-6-106015: Deny TCP (no connection) from 10.151.28.29/58350 to 10.141.28.56/6008 flags ACK  on interface RNODCFWL01_PROD_OUTSIDE

<166>Oct 18 2022 14:08:52 RNODCFWL01A-PROD : %ASA-6-303002: FTP connection from RNODCFWL01_PROD_OUTSIDE:10.142.150.101/56236 to RNODCFWL01_STG_APP_DMZ:10.141.116.36/21, user autoims Stored file 1428_CREATEDNL.UPL

<164>Oct 18 2022 12:46:18 RNODCFWL01A-PROD : %ASA-4-313005: No matching connection for ICMP error message: icmp src RNODCFWL01_PROD_APP_DMZ:10.141.16.225 dst RNODCFWL01_PROD_OUTSIDE:10.143.28.35 (type 3, code 3) on RNODCFWL01_PROD_APP_DMZ interface.  Original IP payload: udp src 10.143.28.35/53 dst 10.141.16.225/54738.

<164>Oct 18 2022 07:09:29 RNODCFWL01A-PROD : %ASA-4-419002: Duplicate TCP SYN from RNODCFWL01_PROD_INSIDE:10.144.66.213/33030 to RNODCFWL01_PROD_INSIDE:10.149.247.202/3000 with different initial sequence number

<166>Oct 17 2022 00:55:05 RNODCFWL01A-PROD : %ASA-6-302010: 43732 in use, 1203671 most used

<164>Oct 16 2022 19:58:57 RNODCFWL01A-PROD : %ASA-4-313004: Denied ICMP type=0, from laddr 10.141.76.146 on interface RNODCFWL01_PROD_INSIDE to 157.185.163.231: no matching session


<164>Oct 26 2022 14:10:20 RNOEEVPN01U : %ASA-4-313005: No matching connection for ICMP error message: icmp src OUTSIDE:10.140.23.181(LOCAL\johndoe) dst INSIDE:10.153.28.34 (type 3, code 3) on OUTSIDE interface.  Original IP payload: udp src 10.153.28.34/53 dst 10.140.23.181/62573.

<166>Oct 26 2022 14:13:13 RNOEEVPN01U : %ASA-6-305011: Built dynamic TCP translation from OUTSIDE:10.140.26.2/62784(LOCAL\johndoe) to OUTSIDE:155.130.6.230/62784

 
<166>Oct 26 2022 14:10:27 RNOEEVPN01U : %ASA-6-725001: Starting SSL handshake with client OUTSIDE:71.78.119.26/51082 to 155.130.6.230/443 for TLS session


<166>Oct 26 2022 14:11:36 RNOEEVPN01U : %ASA-6-725016: Device selects trust-point SERVER123 for client OUTSIDE:172.3.163.81/62621 to 155.130.6.230/443


<166>Oct 26 2022 14:12:41 RNOEEVPN01U : %ASA-6-725002: Device completed SSL handshake with client OUTSIDE:166.137.115.35/37253 to 155.130.6.230/443 for TLSv1.2 session


<166>Oct 26 2022 14:12:55 RNOEEVPN01U : %ASA-6-725007: SSL session with client OUTSIDE:12.40.75.226/62726 to 155.130.6.230/443 terminated


<166>Oct 26 2022 13:43:55 RNOEEVPN01U : %ASA-6-722022: Group <GROUP_ACCOUNT> User <johndoe> IP <223.225.174.132> UDP SVC connection established without compression


<165>Oct 26 2022 12:13:46 RNOEEVPN01U : %ASA-5-722032: Group <GROUP_ACCOUNT> User <johndoe> IP <49.37.252.229> New UDP SVC connection replacing old connection.

 

<165>Oct 26 2022 12:09:28 RNOEEVPN01U : %ASA-5-722028: Group <GROUP_ACCOUNT> User <johndoe> IP <157.35.82.183> Stale SVC connection closed.

-------------------
10/27(update)
-------------------

<166>Oct 27 2022 17:27:46 LASEEVPN01A : %ASA-6-302020: Built inbound ICMP connection for faddr 10.215.115.6/0 gaddr 10.150.23.117/0 laddr 10.150.23.117/0(LOCAL\johndoe) type 3 code 1

 

<166>Oct 27 2022 17:27:37 LASEEVPN01A : %ASA-6-302020: Built inbound ICMP connection for faddr 10.154.66.135/32818 gaddr 10.150.10.11/0 laddr 10.150.10.11/0 type 8 code 0

 
--------------------
New 10/27
--------------------

<164>Oct 27 2022 17:22:32 LASEEVPN01A : %ASA-4-733100: [ Scanning] drop rate-1 exceeded. Current burst rate is 12 per second, max configured rate is 10; Current average rate is 15 per second, max configured rate is 5; Cumulative total count is 9215

 

<166>Oct 27 2022 17:25:54 LASEEVPN01A : %ASA-6-725003: SSL client OUTSIDE:157.35.80.140/54064 to 199.85.76.226/443 request to resume previous session

---------------------
10/27 update
---------------------

<166>Oct 27 2022 17:26:26 LASEEVPN01A : %ASA-6-106100: access-list OUTSIDE_ACCESS denied tcp OUTSIDE/209.191.163.210(443) -> OUTSIDE/10.150.23.247(53119)(LOCAL\johndoe) hit-cnt 1 first hit [0xc263820b, 0x00000000]

-----------------
<166>Oct 18 2022 14:01:57 RNODCFWL01A-PROD : %ASA-6-302013: Built inbound TCP connection 711031808 for RNODCFWL01_PROD_OUTSIDE:10.151.54.35/36665 (10.151.54.35/36665) to RNODCFWL01_PROD_INSIDE:10.141.54.59/6003 (10.141.54.59/6003)
   connectionId: 711031808
   dest_intf: RNODCFWL01_PROD_INSIDE
   direction: inbound
   dst_ip: 10.141.54.59
   dst_port: 6003
   event_id: ASA-6-302013
   host: RNODCFWL01A-PROD
   message: <166>Oct 18 2022 14:01:57 RNODCFWL01A-PROD : %ASA-6-302013: Built inbound TCP connection 711031808 for RNODCFWL01_PROD_OUTSIDE:10.151.54.35/36665 (10.151.54.35/36665) to RNODCFWL01_PROD_INSIDE:10.141.54.59/6003 (10.141.54.59/6003)
   protocol: TCP
   satus: Built
   src_intf: RNODCFWL01_PROD_OUTSIDE
   src_ip: 10.151.54.35
   src_port: 36665
   timestamp: Oct 18 2022 14:01:57 (parsed as: Tue Oct 18, 2022 2:01:57 PM GMT, i.e. 13,756 minutes ago)

<166>Oct 18 2022 14:03:48 RNODCFWL01A-PROD : %ASA-6-302015: Built outbound UDP connection 712485829 for RNODCFWL01_PROD_OUTSIDE:10.143.30.32/53 (10.143.30.32/53) to RNODCFWL01_PROD_APP_DMZ:10.141.18.44/58076 (10.141.18.44/58076)
   connectionId: 712485829
   dest_intf: RNODCFWL01_PROD_APP_DMZ
   direction: outbound
   dst_ip: 10.141.18.44
   dst_port: 58076
   event_id: ASA-6-302015
   host: RNODCFWL01A-PROD
   message: <166>Oct 18 2022 14:03:48 RNODCFWL01A-PROD : %ASA-6-302015: Built outbound UDP connection 712485829 for RNODCFWL01_PROD_OUTSIDE:10.143.30.32/53 (10.143.30.32/53) to RNODCFWL01_PROD_APP_DMZ:10.141.18.44/58076 (10.141.18.44/58076)
   protocol: UDP
   satus: Built
   src_intf: RNODCFWL01_PROD_OUTSIDE
   src_ip: 10.143.30.32
   src_port: 53
   timestamp: Oct 18 2022 14:03:48 (parsed as: Tue Oct 18, 2022 2:03:48 PM GMT, i.e. 13,754 minutes ago)

<166>Oct 18 2022 14:06:21 RNODCFWL01A-PROD : %ASA-6-302020: Built inbound ICMP connection for faddr 10.144.66.211/63417 gaddr 10.141.18.89/0 laddr 10.141.18.89/0 type 8 code 0
   codeId: 0
   direction: inbound
   event_id: ASA-6-302020
   faddrIP: 10.144.66.211
   faddrPort: 63417
   gaddrIP: 10.141.18.89
   gaddrPort: 0
   host: RNODCFWL01A-PROD
   laddrIP: 10.141.18.89
   laddrPort: 0
   message: <166>Oct 18 2022 14:06:21 RNODCFWL01A-PROD : %ASA-6-302020: Built inbound ICMP connection for faddr 10.144.66.211/63417 gaddr 10.141.18.89/0 laddr 10.141.18.89/0 type 8 code 0
   protocol: ICMP
   status: Built
   timestamp: Oct 18 2022 14:06:21 (parsed as: Tue Oct 18, 2022 2:06:21 PM GMT, i.e. 13,751 minutes ago)
   typeId: 8

<166>Oct 18 2022 14:08:08 RNODCFWL01A-PROD : %ASA-6-305011: Built dynamic TCP translation from RNODCFWL01_PROD_INSIDE:10.141.8.61/43812 to RNODCFWL01_PROD_OUTSIDE:199.85.78.192/43812
   NAT: translation
   built_type: dynamic
   dst_intf: RNODCFWL01_PROD_OUTSIDE
   dst_ip: 199.85.78.192
   dst_port: 43812
   event_id: ASA-6-305011
   host: RNODCFWL01A-PROD
   message: <166>Oct 18 2022 14:08:08 RNODCFWL01A-PROD : %ASA-6-305011: Built dynamic TCP translation from RNODCFWL01_PROD_INSIDE:10.141.8.61/43812 to RNODCFWL01_PROD_OUTSIDE:199.85.78.192/43812
   protocol: TCP
   src_intf: RNODCFWL01_PROD_INSIDE
   src_ip: 10.141.8.61
   src_port: 43812
   status: Built
   timestamp: Oct 18 2022 14:08:08 (parsed as: Tue Oct 18, 2022 2:08:08 PM GMT, i.e. 13,749 minutes ago)

<166>Oct 18 2022 14:05:11 RNODCFWL01A-PROD : %ASA-6-106100: access-list RNODCFWL01_PROD_APP_DMZ_ACCESS permitted tcp RNODCFWL01_PROD_APP_DMZ/10.141.18.105(6002) -> RNODCFWL01_PROD_INSIDE/10.149.216.147(3000) hit-cnt 1 first hit [0x28963b44, 0x7162c505]
   details: first hit 
   dst_intf: RNODCFWL01_PROD_INSIDE
   dst_ip: 10.149.216.147
   dst_port: (3000)
   event_id: ASA-6-106100
   fw: RNODCFWL01_PROD_APP_DMZ_ACCESS
   hit-cnt: 1
   host: RNODCFWL01A-PROD
   id: 0x28963b44, 0x7162c505
   message: <166>Oct 18 2022 14:05:11 RNODCFWL01A-PROD : %ASA-6-106100: access-list RNODCFWL01_PROD_APP_DMZ_ACCESS permitted tcp RNODCFWL01_PROD_APP_DMZ/10.141.18.105(6002) -> RNODCFWL01_PROD_INSIDE/10.149.216.147(3000) hit-cnt 1 first hit [0x28963b44, 0x7162c505]
   protocol: tcp
   src_intf: RNODCFWL01_PROD_APP_DMZ
   src_ip: 10.141.18.105
   src_port: 6002
   status: permitted
   timestamp: Oct 18 2022 14:05:11 (parsed as: Tue Oct 18, 2022 2:05:11 PM GMT, i.e. 13,752 minutes ago)
   type: access-list

<166>Oct 18 2022 14:07:28 RNODCFWL01A-PROD : %ASA-6-106015: Deny TCP (no connection) from 10.151.28.29/58350 to 10.141.28.56/6008 flags ACK  on interface RNODCFWL01_PROD_OUTSIDE
   dst_intf: 10.141.28.56
   dst_port: 6008
   event_id: ASA-6-106015
   flag: ACK
   host: RNODCFWL01A-PROD
   intefarce: RNODCFWL01_PROD_OUTSIDE
   message: <166>Oct 18 2022 14:07:28 RNODCFWL01A-PROD : %ASA-6-106015: Deny TCP (no connection) from 10.151.28.29/58350 to 10.141.28.56/6008 flags ACK  on interface RNODCFWL01_PROD_OUTSIDE
   src_intf: 10.151.28.29
   src_port: 58350
   status: Deny TCP (no connection)
   timestamp: Oct 18 2022 14:07:28 (parsed as: Tue Oct 18, 2022 2:07:28 PM GMT, i.e. 13,750 minutes ago)

<166>Oct 18 2022 14:08:52 RNODCFWL01A-PROD : %ASA-6-303002: FTP connection from RNODCFWL01_PROD_OUTSIDE:10.142.150.101/56236 to RNODCFWL01_STG_APP_DMZ:10.141.116.36/21, user autoims Stored file 1428_CREATEDNL.UPL
   dst_intf: RNODCFWL01_STG_APP_DMZ:10.141.116.36
   dst_port: 21
   event_id: ASA-6-303002
   host: RNODCFWL01A-PROD
   message: <166>Oct 18 2022 14:08:52 RNODCFWL01A-PROD : %ASA-6-303002: FTP connection from RNODCFWL01_PROD_OUTSIDE:10.142.150.101/56236 to RNODCFWL01_STG_APP_DMZ:10.141.116.36/21, user autoims Stored file 1428_CREATEDNL.UPL
   msg: user autoims Stored file 1428_CREATEDNL.UPL
   src_intf: RNODCFWL01_PROD_OUTSIDE:10.142.150.101
   src_port: 56236
   status: FTP connection
   timestamp: Oct 18 2022 14:08:52 (parsed as: Tue Oct 18, 2022 2:08:52 PM GMT, i.e. 13,749 minutes ago)

<164>Oct 18 2022 12:46:18 RNODCFWL01A-PROD : %ASA-4-313005: No matching connection for ICMP error message: icmp src RNODCFWL01_PROD_APP_DMZ:10.141.16.225 dst RNODCFWL01_PROD_OUTSIDE:10.143.28.35 (type 3, code 3) on RNODCFWL01_PROD_APP_DMZ interface.  Original IP payload: udp src 10.143.28.35/53 dst 10.141.16.225/54738.
   Original_IP_payload: udp src 10.143.28.35/53 dst 10.141.16.225/54738.
   dst: RNODCFWL01_PROD_OUTSIDE
   dst_ip: 10.143.28.35
   event_id: ASA-4-313005
   host: RNODCFWL01A-PROD
   inteface: RNODCFWL01_PROD_APP_DMZ
   message: <164>Oct 18 2022 12:46:18 RNODCFWL01A-PROD : %ASA-4-313005: No matching connection for ICMP error message: icmp src RNODCFWL01_PROD_APP_DMZ:10.141.16.225 dst RNODCFWL01_PROD_OUTSIDE:10.143.28.35 (type 3, code 3) on RNODCFWL01_PROD_APP_DMZ interface.  Original IP payload: udp src 10.143.28.35/53 dst 10.141.16.225/54738.
   msg: No matching connection for ICMP error message: icmp
   src: RNODCFWL01_PROD_APP_DMZ
   src_ip: 10.141.16.225
   timestamp: Oct 18 2022 12:46:18 (parsed as: Tue Oct 18, 2022 12:46:18 PM GMT, i.e. 13,831 minutes ago)
   type: (type 3, code 3)

<164>Oct 18 2022 07:09:29 RNODCFWL01A-PROD : %ASA-4-419002: Duplicate TCP SYN from RNODCFWL01_PROD_INSIDE:10.144.66.213/33030 to RNODCFWL01_PROD_INSIDE:10.149.247.202/3000 with different initial sequence number
   dst_intf: RNODCFWL01_PROD_INSIDE
   dst_ip: 10.149.247.202
   dst_port: 3000
   err_msg: different initial sequence number
   event_id: ASA-4-419002
   host: RNODCFWL01A-PROD
   message: <164>Oct 18 2022 07:09:29 RNODCFWL01A-PROD : %ASA-4-419002: Duplicate TCP SYN from RNODCFWL01_PROD_INSIDE:10.144.66.213/33030 to RNODCFWL01_PROD_INSIDE:10.149.247.202/3000 with different initial sequence number
   msg: Duplicate TCP SYN
   src_intf: RNODCFWL01_PROD_INSIDE
   src_ip: 10.144.66.213
   src_port: 33030
   timestamp: Oct 18 2022 07:09:29 (parsed as: Tue Oct 18, 2022 7:09:29 AM GMT, i.e. 14,168 minutes ago)

<166>Oct 17 2022 00:55:05 RNODCFWL01A-PROD : %ASA-6-302010: 43732 in use, 1203671 most used
   event_id: ASA-6-302010
   host: RNODCFWL01A-PROD
   in_use: 43732
   message: <166>Oct 17 2022 00:55:05 RNODCFWL01A-PROD : %ASA-6-302010: 43732 in use, 1203671 most used
   most_used: 1203671
   timestamp: Oct 17 2022 00:55:05 (parsed as: Mon Oct 17, 2022 12:55:05 AM GMT, i.e. 15,982 minutes ago)

<164>Oct 16 2022 19:58:57 RNODCFWL01A-PROD : %ASA-4-313004: Denied ICMP type=0, from laddr 10.141.76.146 on interface RNODCFWL01_PROD_INSIDE to 157.185.163.231: no matching session
   dst_ip: 157.185.163.231
   event_id: ASA-4-313004
   host: RNODCFWL01A-PROD
   laddr_ip: 10.141.76.146
   message: <164>Oct 16 2022 19:58:57 RNODCFWL01A-PROD : %ASA-4-313004: Denied ICMP type=0, from laddr 10.141.76.146 on interface RNODCFWL01_PROD_INSIDE to 157.185.163.231: no matching session
   msg: no matching session
   protocol: ICMP type=0
   src_intf: RNODCFWL01_PROD_INSIDE
   status: Denied
   timestamp: Oct 16 2022 19:58:57 (parsed as: Sun Oct 16, 2022 7:58:57 PM GMT, i.e. 16,279 minutes ago)

<164>Oct 26 2022 14:10:20 RNOEEVPN01U : %ASA-4-313005: No matching connection for ICMP error message: icmp src OUTSIDE:10.140.23.181(LOCAL\johndoe) dst INSIDE:10.153.28.34 (type 3, code 3) on OUTSIDE interface.  Original IP payload: udp src 10.153.28.34/53 dst 10.140.23.181/62573.
   dst_intf: INSIDE
   dst_ip: 10.153.28.34
   event_id: ASA-4-313005
   host: RNOEEVPN01U
   message: <164>Oct 26 2022 14:10:20 RNOEEVPN01U : %ASA-4-313005: No matching connection for ICMP error message: icmp src OUTSIDE:10.140.23.181(LOCAL\johndoe) dst INSIDE:10.153.28.34 (type 3, code 3) on OUTSIDE interface.  Original IP payload: udp src 10.153.28.34/53 dst 10.140.23.181/62573.
   payload: udp src 10.153.28.34/53 dst 10.140.23.181/62573.
   protocol: ICMP
   src_intf: OUTSIDE
   src_ip: 10.140.23.181
   status: No matching connection
   timestamp: Oct 26 2022 14:10:20 (parsed as: Wed Oct 26, 2022 2:10:20 PM GMT, i.e. 2227 minutes ago)
   type: 3, code 3

<166>Oct 26 2022 14:13:13 RNOEEVPN01U : %ASA-6-305011: Built dynamic TCP translation from OUTSIDE:10.140.26.2/62784(LOCAL\johndoe) to OUTSIDE:155.130.6.230/62784
   dst_intf: OUTSIDE
   dst_ip: 155.130.6.230
   event_id: ASA-6-305011
   host: RNOEEVPN01U
   message: <166>Oct 26 2022 14:13:13 RNOEEVPN01U : %ASA-6-305011: Built dynamic TCP translation from OUTSIDE:10.140.26.2/62784(LOCAL\johndoe) to OUTSIDE:155.130.6.230/62784
   src_intf: OUTSIDE
   src_ip: 10.140.26.2
   status: Built dynamic TCP translation
   timestamp: Oct 26 2022 14:13:13 (parsed as: Wed Oct 26, 2022 2:13:13 PM GMT, i.e. 2224 minutes ago)

<166>Oct 26 2022 14:10:27 RNOEEVPN01U : %ASA-6-725001: Starting SSL handshake with client OUTSIDE:71.78.119.26/51082 to 155.130.6.230/443 for TLS session
   dst_ip: 155.130.6.230
   dst_port: 443 for TLS session
   event_id: ASA-6-725001
   host: RNOEEVPN01U
   message: <166>Oct 26 2022 14:10:27 RNOEEVPN01U : %ASA-6-725001: Starting SSL handshake with client OUTSIDE:71.78.119.26/51082 to 155.130.6.230/443 for TLS session
   src_intf: OUTSIDE
   src_ip: 71.78.119.26
   src_port: 51082
   status: Starting SSL handshake
   timestamp: Oct 26 2022 14:10:27 (parsed as: Wed Oct 26, 2022 2:10:27 PM GMT, i.e. 2227 minutes ago)

<166>Oct 26 2022 14:11:36 RNOEEVPN01U : %ASA-6-725016: Device selects trust-point SERVER123 for client OUTSIDE:172.3.163.81/62621 to 155.130.6.230/443
   dst_ip: 155.130.6.230
   dst_port: 443
   event_id: ASA-6-725016
   host: RNOEEVPN01U
   message: <166>Oct 26 2022 14:11:36 RNOEEVPN01U : %ASA-6-725016: Device selects trust-point SERVER123 for client OUTSIDE:172.3.163.81/62621 to 155.130.6.230/443
   src_intf: OUTSIDE
   src_ip: 172.3.163.81
   src_port: 62621
   status: Device selects
   timestamp: Oct 26 2022 14:11:36 (parsed as: Wed Oct 26, 2022 2:11:36 PM GMT, i.e. 2226 minutes ago)
   trust_host: SERVER123

<166>Oct 26 2022 14:12:41 RNOEEVPN01U : %ASA-6-725002: Device completed SSL handshake with client OUTSIDE:166.137.115.35/37253 to 155.130.6.230/443 for TLSv1.2 session
   dst_ip: 155.130.6.230
   dst_port: 443 for TLSv1.2 session
   event_id: ASA-6-725002
   host: RNOEEVPN01U
   message: <166>Oct 26 2022 14:12:41 RNOEEVPN01U : %ASA-6-725002: Device completed SSL handshake with client OUTSIDE:166.137.115.35/37253 to 155.130.6.230/443 for TLSv1.2 session
   src_intf: OUTSIDE
   src_ip: 166.137.115.35
   src_port: 37253
   status: Device completed SSL handshake
   timestamp: Oct 26 2022 14:12:41 (parsed as: Wed Oct 26, 2022 2:12:41 PM GMT, i.e. 2225 minutes ago)

<166>Oct 26 2022 14:12:55 RNOEEVPN01U : %ASA-6-725007: SSL session with client OUTSIDE:12.40.75.226/62726 to 155.130.6.230/443 terminated
   dst_ip: 155.130.6.230
   dst_port: 443 terminated
   event_id: ASA-6-725007
   host: RNOEEVPN01U
   message: <166>Oct 26 2022 14:12:55 RNOEEVPN01U : %ASA-6-725007: SSL session with client OUTSIDE:12.40.75.226/62726 to 155.130.6.230/443 terminated
   src_intf: OUTSIDE
   src_ip: 12.40.75.226
   src_port: 62726
   status: SSL session
   timestamp: Oct 26 2022 14:12:55 (parsed as: Wed Oct 26, 2022 2:12:55 PM GMT, i.e. 2225 minutes ago)

<166>Oct 26 2022 13:43:55 RNOEEVPN01U : %ASA-6-722022: Group <GROUP_ACCOUNT> User <johndoe> IP <223.225.174.132> UDP SVC connection established without compression
   event_id: ASA-6-722022
   host: RNOEEVPN01U
   ip: 223.225.174.132
   message: <166>Oct 26 2022 13:43:55 RNOEEVPN01U : %ASA-6-722022: Group <GROUP_ACCOUNT> User <johndoe> IP <223.225.174.132> UDP SVC connection established without compression
   msg: Group <GROUP_ACCOUNT> User <johndoe>
   status: UDP SVC connection established without compression
   timestamp: Oct 26 2022 13:43:55 (parsed as: Wed Oct 26, 2022 1:43:55 PM GMT, i.e. 2254 minutes ago)

<165>Oct 26 2022 12:13:46 RNOEEVPN01U : %ASA-5-722032: Group <GROUP_ACCOUNT> User <johndoe> IP <49.37.252.229> New UDP SVC connection replacing old connection.
   event_id: ASA-5-722032
   host: RNOEEVPN01U
   ip: 49.37.252.229
   message: <165>Oct 26 2022 12:13:46 RNOEEVPN01U : %ASA-5-722032: Group <GROUP_ACCOUNT> User <johndoe> IP <49.37.252.229> New UDP SVC connection replacing old connection.
   msg: Group <GROUP_ACCOUNT> User <johndoe>
   status: New UDP SVC connection replacing old connection.
   timestamp: Oct 26 2022 12:13:46 (parsed as: Wed Oct 26, 2022 12:13:46 PM GMT, i.e. 2344 minutes ago)

<165>Oct 26 2022 12:09:28 RNOEEVPN01U : %ASA-5-722028: Group <GROUP_ACCOUNT> User <johndoe> IP <157.35.82.183> Stale SVC connection closed.
   event_id: ASA-5-722028
   host: RNOEEVPN01U
   ip: 157.35.82.183
   message: <165>Oct 26 2022 12:09:28 RNOEEVPN01U : %ASA-5-722028: Group <GROUP_ACCOUNT> User <johndoe> IP <157.35.82.183> Stale SVC connection closed.
   msg: Group <GROUP_ACCOUNT> User <johndoe>
   status: Stale SVC connection closed.
   timestamp: Oct 26 2022 12:09:28 (parsed as: Wed Oct 26, 2022 12:09:28 PM GMT, i.e. 2348 minutes ago)

-------------------

10/27(update)

-------------------

<166>Oct 27 2022 17:27:46 LASEEVPN01A : %ASA-6-302020: Built inbound ICMP connection for faddr 10.215.115.6/0 gaddr 10.150.23.117/0 laddr 10.150.23.117/0(LOCAL\johndoe) type 3 code 1
   codeId: 1
   direction: inbound
   event_id: ASA-6-302020
   faddrIP: 10.215.115.6
   faddrPort: 0
   gaddrIP: 10.150.23.117
   gaddrPort: 0
   host: LASEEVPN01A
   laddrIP: 10.150.23.117
   laddrPort: 0(LOCAL\johndoe)
   message: <166>Oct 27 2022 17:27:46 LASEEVPN01A : %ASA-6-302020: Built inbound ICMP connection for faddr 10.215.115.6/0 gaddr 10.150.23.117/0 laddr 10.150.23.117/0(LOCAL\johndoe) type 3 code 1
   protocol: ICMP
   status: Built
   timestamp: Oct 27 2022 17:27:46 (parsed as: Thu Oct 27, 2022 5:27:46 PM GMT, i.e. 590 minutes ago)
   typeId: 3

<166>Oct 27 2022 17:27:37 LASEEVPN01A : %ASA-6-302020: Built inbound ICMP connection for faddr 10.154.66.135/32818 gaddr 10.150.10.11/0 laddr 10.150.10.11/0 type 8 code 0
   codeId: 0
   direction: inbound
   event_id: ASA-6-302020
   faddrIP: 10.154.66.135
   faddrPort: 32818
   gaddrIP: 10.150.10.11
   gaddrPort: 0
   host: LASEEVPN01A
   laddrIP: 10.150.10.11
   laddrPort: 0
   message: <166>Oct 27 2022 17:27:37 LASEEVPN01A : %ASA-6-302020: Built inbound ICMP connection for faddr 10.154.66.135/32818 gaddr 10.150.10.11/0 laddr 10.150.10.11/0 type 8 code 0
   protocol: ICMP
   status: Built
   timestamp: Oct 27 2022 17:27:37 (parsed as: Thu Oct 27, 2022 5:27:37 PM GMT, i.e. 590 minutes ago)
   typeId: 8

--------------------

New 10/27

--------------------

<164>Oct 27 2022 17:22:32 LASEEVPN01A : %ASA-4-733100: [ Scanning] drop rate-1 exceeded. Current burst rate is 12 per second, max configured rate is 10; Current average rate is 15 per second, max configured rate is 5; Cumulative total count is 9215
   event_id: ASA-4-733100
   host: LASEEVPN01A
   message: <164>Oct 27 2022 17:22:32 LASEEVPN01A : %ASA-4-733100: [ Scanning] drop rate-1 exceeded. Current burst rate is 12 per second, max configured rate is 10; Current average rate is 15 per second, max configured rate is 5; Cumulative total count is 9215
   msg: Current burst rate is 12 per second, max configured rate is 10; Current average rate is 15 per second, max configured rate is 5; Cumulative total count is 9215
   state:  Scanning
   status: drop rate-1 exceeded
   timestamp: Oct 27 2022 17:22:32 (parsed as: Thu Oct 27, 2022 5:22:32 PM GMT, i.e. 595 minutes ago)

<166>Oct 27 2022 17:25:54 LASEEVPN01A : %ASA-6-725003: SSL client OUTSIDE:157.35.80.140/54064 to 199.85.76.226/443 request to resume previous session
   dst_ip: 199.85.76.226
   dst_port: 443
   event_id: ASA-6-725003
   host: LASEEVPN01A
   message: <166>Oct 27 2022 17:25:54 LASEEVPN01A : %ASA-6-725003: SSL client OUTSIDE:157.35.80.140/54064 to 199.85.76.226/443 request to resume previous session
   msg: request to resume previous session
   src_intf: 157.35.80.140
   src_port: 54064
   status: SSL client
   timestamp: Oct 27 2022 17:25:54 (parsed as: Thu Oct 27, 2022 5:25:54 PM GMT, i.e. 592 minutes ago)

---------------------

10/27 update

---------------------

<166>Oct 27 2022 17:26:26 LASEEVPN01A : %ASA-6-106100: access-list OUTSIDE_ACCESS denied tcp OUTSIDE/209.191.163.210(443) -> OUTSIDE/10.150.23.247(53119)(LOCAL\johndoe) hit-cnt 1 first hit [0xc263820b, 0x00000000]
   details: first hit 
   dst_intf: OUTSIDE
   dst_ip: 10.150.23.247
   dst_port: (53119)(LOCAL\johndoe)
   event_id: ASA-6-106100
   fw: OUTSIDE_ACCESS
   hit-cnt: 1
   host: LASEEVPN01A
   id: 0xc263820b, 0x00000000
   message: <166>Oct 27 2022 17:26:26 LASEEVPN01A : %ASA-6-106100: access-list OUTSIDE_ACCESS denied tcp OUTSIDE/209.191.163.210(443) -> OUTSIDE/10.150.23.247(53119)(LOCAL\johndoe) hit-cnt 1 first hit [0xc263820b, 0x00000000]
   protocol: tcp
   src_intf: OUTSIDE
   src_ip: 209.191.163.210
   src_port: 443
   status: denied
   timestamp: Oct 27 2022 17:26:26 (parsed as: Thu Oct 27, 2022 5:26:26 PM GMT, i.e. 591 minutes ago)
   type: access-list


 
*/






{
  // specify a time zone if the timestamps in your log are not in GMT
  // timezone: "GMT-0800"
  patterns: {
    alphaOnly: "[a-zA-Z]+",
    alphaNum: "[a-zA-Z0-9]+",
    notWS: "[^\\s]+",
    notComma: "[^,]+",
    tsPattern: "\\w+ \\d{1,2} \\d{2}:\\d{2}:\\d{2}",
    ipv46: "((\\d{1,3}\\.){3}\\d{1,3}|([a-fA-F0-9]{1,4}:?)+)+",
    fglPattern: "(faddr|gaddr|laddr)"
  },
  formats: [
    {
      format: ".*Configuration-Changes: $ConfigurationChanges$,"
    }, {
      format: "\\<\\d+\\>$timestamp=tsPattern$ $hostname=identifier$ $Category$ $seq_number=number$ .*"
    }, {
      format: ".*$_=identifier$=$_=notComma{attrBlacklist=cisco-av-pair}$,.*",
      repeat: true
    }, {
      format: "\\<\\d+\\>\\%ASA-$level$-$message_number$: access-list $aclname$ $aclaction$ $protocol$ $srcif$/$srcip$\\($srcport$\\) $direction$ $destif$/$destip$\\($dstport$\\) $hitcnt$"
    }, {
      format: "\\<\\d+\\>$timestamp=tsPattern$ $host$ : .*"
    }, {
      id: "built_1",
      format: "\\<\\d+\\>\\%ASA-$level$-$message_number$: Built $direction=alphaOnly$ $protocol=alphaOnly$ connection $connectionId=number$ for $host1$:$ip1=ipv46$\/$port1=number$ \\(.+\\) to $host2$:$ip2=ipv46$\/$port2=number$ \\(.+\\)$$"
      halt: true
    }, {
      id: "built_2",
      format: "\\<\\d+\\>\\%ASA-$level$-$message_number$: Built $direction=alphaOnly$ $protocol=alphaOnly$ connection for faddr $faddrIP=ipv46$\/$faddrPort=number$ gaddr $gaddrIP=ipv46$\/$gaddrPort=number$ laddr $laddrIP=ipv46$\/$laddrPort=number$ type $typeId=number$ code $codeId=number$$$"
      halt: true
    }, {
      id: "built_3",
      format: "\\<\\d+\\>\\%ASA-$level$-$message_number$: Built dynamic $protocol=alphaOnly$ translation from $host1$:$ip1=ipv46$\/$port1=number$ to $host2$:$ip2=ipv46$\/$port2=number$$$"
      halt: true
    }, {
      id: "teardown_1",
      format: "\\<\\d+\\>\\%ASA-$level$-$message_number$: Teardown $protocol=alphaOnly$ connection $connectionId=number$ for $host1$:$ip1=ipv46$\/$port1=number$ to $host2$:$ip2=ipv46$\/$port2=number$ duration $duration{parse=hoursMinutesSeconds}$ bytes $bytes=number$.*"
      halt: true
    }, {
      id: "format1",
      format: ".*$=json{parse=dottedJson}$"
      rewrites: [
        {
          input: "TimestampConnectionEnd",
          output: "timestamp",
          match: ".*",
          replace: "$0"
        }
        //  moved upstread wher it is more efficient
        {
          input: "message",
          output: "message",
          match: "(.*\")(\\{\"\\w+\".*)",
          replace: "$2"
        }
      
      ]
    }
  ]
}



/*
<166>%ASA-6-302014: Teardown TCP connection 1196151882 for outside:172.17.229.88/55063 to inside:172.16.1.80/61104 duration 0:00:00 bytes 0 TCP Reset-I from inside
   bytes: 0
   connectionId: 1196151882
   duration: 0.0
   host1: outside
   host2: inside
   ip1: 172.17.229.88
   ip2: 172.16.1.80
   level: 6
   message: <166>%ASA-6-302014: Teardown TCP connection 1196151882 for outside:172.17.229.88/55063 to inside:172.16.1.80/61104 duration 0:00:00 bytes 0 TCP Reset-I from inside
   message_number: 302014
   port1: 55063
   port2: 61104
   protocol: TCP
   teardown_1: true


   {
  // specify a time zone if the timestamps in your log are not in GMT
  // timezone: "GMT-0800"
  patterns: {
    tsPattern: "\\w{3} \\d{1,2} \\d{4} \\d{2}:\\d{2}:\\d{2}",
    ipv46: "((\\d{1,3}\\.){3}\\d{1,3}|([a-fA-F0-9]{1,4}:?)+)+",
    alphaOnly: "[a-zA-Z]+",
    fglPattern: "(faddr|gaddr|laddr)",
  },
  formats: [
    {
      format: "\\<\\d+\\>$timestamp=tsPattern$ $host$ : .*"
    },
    {
      id: "built_1",
      format: ".* : %[^\\:]+: Built $direction=alphaOnly$ $protocol=alphaOnly$ connection $connectionId=number$ for $host1$:$ip1=ipv46$\/$port1=number$ \\(.+\\) to $host2$:$ip2=ipv46$\/$port2=number$ \\(.+\\)$$"
      halt: true
    },
    {
      id: "built_2",
      format: ".* : %[^\\:]+: Built $direction=alphaOnly$ $protocol=alphaOnly$ connection for faddr $faddrIP=ipv46$\/$faddrPort=number$ gaddr $gaddrIP=ipv46$\/$gaddrPort=number$ laddr $laddrIP=ipv46$\/$laddrPort=number$ type $typeId=number$ code $codeId=number$$$"
      halt: true
    },
    {
      id: "built_3",
      format: ".* : %[^\\:]+: Built dynamic $protocol=alphaOnly$ translation from $host1$:$ip1=ipv46$\/$port1=number$ to $host2$:$ip2=ipv46$\/$port2=number$$$"
      halt: true
    }, 
    {
      id: "teardown_1",
      format: ".* : %[^\\:]+: Teardown $protocol=alphaOnly$ connection $connectionId=number$ for $host1$:$ip1=ipv46$\/$port1=number$ to $host2$:$ip2=ipv46$\/$port2=number$ $_=alphaOnly$ $_$ $_=alphaOnly$ $_$$$"
      halt: true
    },
  ]
}
------------------------------

{  // specify a time zone if the timestamps in your log are not in GMT
  // timezone: "GMT-0800"
  patterns: {
    tsPattern: "\\w+\\s\\d+\\s\\d+\\s\\d+:\\d+:\\d+",
    keyPattern: "(connection|duration|bytes)"
    ipPattern: "\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}"
  }
  formats: [

    {
      format: "\\<\\d+\\>$timestamp=tsPattern$: $var_0$: "
    }
    {
      format: ".*(TCP|tcp).*"
      attributes: {protocol: "tcp"}
    }
    {
      format: ".*(UDP|udp).*"
      attributes: {protocol: "udp"}
    }
    {
      format: ".*(ICMP|icmp).*"
      attributes: {protocol: "icmp"}
    }
    {
      format: ".*$_=keyPattern$(\\s|:)$_=quoteOrSpace$.*"
      repeat: true 
    }
 
    {
    format: ".*inside(:|/)$ip_i=ipPattern$(/|\\()$port_i=number$\\)?"
    }
    {
    format: ".*outside(:|/)$ip_o=ipPattern$(/|\\()$port_o=number$\\)?"
    }
    {
    format: ".*from $ip_i=ipPattern$/$port_i=number$"
    }
    {
    format: ".*to $ip_o=ipPattern$/$port_o=number$"
    }
    {
    format: ".*(denied).*"
    attributes: {status: "denied"}
    }
    {
      format: "\\<\\d+\\>$timestamp=tsPattern$: $var_0$: $var_1$ $var_2$ $status$ $protocol$ $var_3$/$ip_i$\\($port_i$\\) -> $var_4$/$ip_o$\\($port_o$\\) $var_5$ $var_6$ $details$\\[$var_7$, $var_8$\\]"
    },
    {
      format: "$timestamp$ $system$ $path$ \\<\\d+\\>$original_ts=tsPattern$: $var_0$: $var_1$ $var_2$ $status$ $protocol$ $var_3$/$ip_i$\\($port_i$\\) -> $var_4$/$ip_o$\\($port_o$\\) $var_5$ $var_6$ $details$\\[$var_7$, $var_8$\\]"
    }
  ]
}
-----------------------------------------------


{
  // specify a time zone if the timestamps in your log are not in GMT
  // timezone: "GMT-0800"
  patterns: {
    tsPattern: "\\w{3} \\d{1,2} \\d{4} \\d{2}:\\d{2}:\\d{2}",
    tsPattern2: "\\w{3} \\d{1,2} \\d{2}:\\d{2}:\\d{2}",
    ipv46: "((\\d{1,3}\\.){3}\\d{1,3}|([a-fA-F0-9]{1,4}:?)+)+",
    ipv4_ipv6: "(((\\d{1,3}\\.){3}\\d{1,3})|((([0-9a-fA-F]){1,4})\\:){7}([0-9a-fA-F]){1,4})",
    alphaOnly: "[a-zA-Z]+",
    fglPattern: "(faddr|gaddr|laddr)",
  },
  formats: [
    {
      format: "\\<\\d+\\>$timestamp=tsPattern$ $host$ .*"
    }, {
      format: "\\<\\d+\\>$timestamp=tsPattern2$ $host$ .*"
    }, {
      id: "built_1",
      format: ".* : %[^\\:]+: Built $direction=alphaOnly$ $protocol=alphaOnly$ connection $connectionId=number$ for $host1$:$ip1=ipv46$\/$port1=number$ \\(.+\\) to $host2$:$ip2=ipv46$\/$port2=number$ \\(.+\\)$$"
      halt: true
    }, {
      id: "built_2",
      format: ".* : %[^\\:]+: Built $direction=alphaOnly$ $protocol=alphaOnly$ connection for faddr $faddrIP=ipv46$\/$faddrPort=number$ gaddr $gaddrIP=ipv46$\/$gaddrPort=number$ laddr $laddrIP=ipv46$\/$laddrPort=number$ type $typeId=number$ code $codeId=number$$$"
      halt: true
    }, {
      id: "built_3",
      format: ".* : %[^\\:]+: Built dynamic $protocol=alphaOnly$ translation from $host1$:$ip1=ipv46$\/$port1=number$ to $host2$:$ip2=ipv46$\/$port2=number$$$"
      halt: true
    }, {
      id: "built_4",
      format: ".*,$CDN_IP=ipv4_ipv6$,$VIP_IP=ipv4_ipv6$,$FW_IP=ipv4_ipv6$.*CDN_TO_RNO_PUBLIC_SUBNETS"
      halt: true
    }, {
      id: "teardown_1",
      format: ".* : %[^\\:]+: Teardown $protocol=alphaOnly$ connection $connectionId=number$ for $host1$:$ip1=ipv46$\/$port1=number$ to $host2$:$ip2=ipv46$\/$port2=number$ $_=alphaOnly$ $_$ $_=alphaOnly$ $_$$$"
      halt: true
    },
  ]
}