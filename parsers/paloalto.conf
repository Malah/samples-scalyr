{
  // specify a time zone if the timestamps in your log are not in GMT
  timezone: "America/Los_Angeles"
  
  patterns: {
	datetime: "(\\d+ \\w+ \\d+ \\d+:\\d+:\\d+\\.\\d+ \\w+ \\-\\d+:\\d+"  //firewall
    +         "|(\\d+\/\\d+\/\\d+|\\w+\\s\\d+)\\s\\d+:\\d+:\\d+)"        //vpn
    valuePattern: "[,:$$\\s]"
  }
  formats: [
    //************
    //  Palo Alto Networks Firewall Parser 
    //  This will parse logs that are defined in palo alto's documentation. https://docs.paloaltonetworks.com/pan-os/9-1/pan-os-admin/monitoring/view-and-manage-logs/log-types-and-severity-levels
    //  This parses Traffic, System and Threat logs
    //************

    //traffic log type
    //Fields  FUTURE_USE, Receive Time, Serial Number, Type, Threat/Content Type, FUTURE_USE, Generated Time, Source IP, Destination IP, NAT Source IP, NAT Destination IP, Rule Name, Source User, Destination User, Application, Virtual System, Source Zone, Destination Zone, Inbound Interface, Outbound Interface, Log Action, FUTURE_USE, Session ID, Repeat Count, Source Port, Destination Port, NAT Source Port, NAT Destination Port, Flags, Protocol, Action, Bytes, Bytes Sent, Bytes Received, Packets, Start Time, Elapsed Time, Category, FUTURE_USE, Sequence Number, Action Flags, Source Location, Destination Location, FUTURE_USE, Packets Sent, Packets Received, Session End Reason, Device Group Hierarchy Level 1, Device Group Hierarchy Level 2, Device Group Hierarchy Level 3, Device Group Hierarchy Level 4, Virtual System Name, Device Name, Action Source, Source VM UUID, Destination VM UUID, Tunnel ID/IMSI, Monitor Tag/IMEI, Parent Session ID, Parent Start Time, Tunnel Type, SCTP Association ID, SCTP Chunks, SCTP Chunks Sent, SCTP Chunks Received

    {
      id: "Traffic"
      format: ".*\\<[^\\>]+\\>$timestamp=datetime{timezone=America/Los_Angeles}$ $FUTURE_USE1$,$Receive_Time$,$Serial_Number$,TRAFFIC,$Threat-Content_Type$,$FUTURE_USE2$,$Generated_Time$,$Source_IP$,$Destination_IP$,$NAT_Source_IP$,$NAT_Destination_IP$,$Rule_Name$,$Source_User$,$Destination_User$,$Application$,$Virtual_System$,$Source_Zone$,$Destination_Zone$,$Inbound_Interface$,$Outbound_Interface$,$Log_Action$,$FUTURE_USE3$,$Session_ID$,$Repeat_Count$,$Source_Port$,$Destination_Port$,$NAT_Source_Port$,$NAT_Destination_Port$,$Flags$,$Protocol$,$Action$,$Bytes$,$Bytes_Sent$,$Bytes_Received$,$Packets$,$Start_Time$,$Elapsed_Time$,$Category$,$FUTURE_USE4$"
      attributes: {Type: "TRAFFIC"}
    },
    {
      id: "Traffic"
      format: ".*\\<[^\\>]+\\>$timestamp=datetime{timezone=America/Los_Angeles}$ $FUTURE_USE1$,$Receive_Time$,$Serial_Number$,TRAFFIC,$Threat-Content_Type$,$FUTURE_USE2$,$Generated_Time$,$Source_IP$,$Destination_IP$,$NAT_Source_IP$,$NAT_Destination_IP$,$Rule_Name$,$Source_User$,$Destination_User$,$Application$,$Virtual_System$,$Source_Zone$,$Destination_Zone$,$Inbound_Interface$,$Outbound_Interface$,$Log_Action$,$FUTURE_USE3$,$Session_ID$,$Repeat_Count$,$Source_Port$,$Destination_Port$,$NAT_Source_Port$,$NAT_Destination_Port$,$Flags$,$Protocol$,$Action$,$Bytes$,$Bytes_Sent$,$Bytes_Received$,$Packets$,$Start_Time$,$Elapsed_Time$,$Category$,$FUTURE_USE4$,$Sequence_Number$,$Action_Flags$,$Source_Location$,$Destination_Location$,$FUTURE_USE5$,$Packets_Sent$,$Packets_Received$,$Session_End_Reason$,$Device_Group_Hierarchy_Level_1$,$Device_Group_Hierarchy_Level_2$,$Device_Group_Hierarchy_Level_3$,$Device_Group_Hierarchy_Level_4$,$Virtual_System_Name$,$Device_Name$,$Action_Source$,$Source_VM_UUID$,$Destination_VM_UUID$,$Tunnel_ID-IMSI$,$Monitor_Tag-IMEI$,$Parent_Session_ID$,$Parent_Start_Time$,$Tunnel_Type$,$SCTP_Association_ID$,$SCTP_Chunks$,$SCTP_Chunks_Sent$,$SCTP_Chunks_Received$"
      attributes: {Type: "TRAFFIC"}

    },
      {
      id: "Traffic"
      format: ".*\\<[^\\>]+\\>$timestamp=datetime{timezone=America/Los_Angeles}$ $FUTURE_USE$,$Receive_Time$,$Serial_Number$,TRAFFIC,$Threat$,$Content_Type$,$FUTURE_USE$,$Generated_Time$,$Source_Address$,$Destination_Address$,$NAT_Source_IP$,$NAT_Destination_IP$,$Rule_Name$,$Source_User$,$Destination_User$,$Application$,$Virtual_System$,$Source_Zone$,$Destination_Zone$,$Inbound_Interface$,$Outbound_Interface$,$Log_Action$,$FUTURE_USE$,$Session_ID$,$Repeat_Count$,$Source_Port$,$Destination_Port$,$NAT_Source_Port$,$NAT_Destination_Port$,$Flags$,$Protocol$,$Action$,$Bytes$,$Bytes_Sent$,$Bytes_Received$,$Packets$,$Start_Time$,$Elapsed_Time$,$Category$,$FUTURE_USE$,$Sequence_Number$,$Action_Flags$,$Source_Location$,$Destination_Location$,$FUTURE_USE$,$Packets_Sent$,$Packets_Received$,$Session_End_Reason$,$Device_GroupHierarchy_Level_1$,$Device_GroupHierarchy_Level_2$,$Device_GroupHierarchy_Level_3$,$Device_GroupHierarchy_Level_4$,$Virtual_System_Name$,$Device_Name$,$Action_Source$,$Source_VM_UUID$,$Destination_VM_UUID$,$Tunnel_ID$/$IMSI$,$Monitor_Tag$,$IMEI$,$Parent_Session_ID$,$Parent_Start_Time$,$Tunnel_Type$,$SCTP_Association_ID$,$SCTP_Chunks$,$SCTP_Chunks_Sent$,$SCTP_Chunks_Received$,$UUID_for_rule$,$HTTP_2_Connection$,$extra$"
      attributes: {Type: "TRAFFIC"}
      halt: true
    },
    
    //Threat logtype
    //Fields  FUTURE_USE, Receive Time, Serial Number, Type, Threat/Content Type, FUTURE_USE, Generated Time, Source IP, Destination IP, NAT Source IP, NAT Destination IP, Rule Name, Source User, Destination User, Application, Virtual System, Source Zone, Destination Zone, Inbound Interface, Outbound Interface, Log Action, FUTURE_USE, Session ID, Repeat Count, Source Port, Destination Port, NAT Source Port, NAT Destination Port, Flags, Protocol, Action, Bytes, Bytes Sent, Bytes Received, Packets, Start Time, Elapsed Time, Category, FUTURE_USE, Sequence Number, Action Flags, Source Location, Destination Location, FUTURE_USE, Packets Sent, Packets Received, Session End Reason, Device Group Hierarchy Level 1, Device Group Hierarchy Level 2, Device Group Hierarchy Level 3, Device Group Hierarchy Level 4, Virtual System Name, Device Name, Action Source, Source VM UUID, Destination VM UUID, Tunnel ID/IMSI, Monitor Tag/IMEI, Parent Session ID, Parent Start Time, Tunnel Type, SCTP Association ID, SCTP Chunks, SCTP Chunks Sent, SCTP Chunks Received
    {
      id: "Threat"
      format: ".*\\<[^\\>]+\\>$timestamp=datetime{timezone=America/Los_Angeles}$ $FUTURE_USE$,$Receive_Time$,$Serial_Number$,THREAT,$Threat-Content_Type$,$FUTURE_USE$,$Generated_Time$,$Source_IP$,$Destination_IP$,$NAT_Source_IP$,$NAT_Destination_IP$,$Rule_Name$,$Source_User$,$Destination_User$,$Application$,$Virtual_System$,$Source_Zone$,$Destination_Zone$,$Inbound_Interface$,$Outbound_Interface$,$Log_Action$,$FUTURE_USE$,$Session_ID$,$Repeat_Count$,$Source_Port$,$Destination_Port$,$NAT_Source_Port$,$NAT_Destination_Port$,$Flags$,$Protocol$,$Action$,$URL-Filename$,$Threat_ID$,$Category$,$Severity$,$Direction$"
      attributes: {"severity": "CRITICAL", Type: "THREAT"}
      halt: true
    },
//system
      //Fields FUTURE_USE, Receive Time, Serial Number, Type, Content/Threat Type, FUTURE_USE, Generated Time, Virtual System, Event ID, Object, FUTURE_USE, FUTURE_USE, Module, Severity, Description, Sequence Number, Action Flags, Device Group Hierarchy Level 1, Device Group Hierarchy Level 2, Device Group Hierarchy Level 3, Device Group Hierarchy Level 4, Virtual System Name, Device Name
    {
      id: "System"
      format: ".*\\<[^\\>]+\\>$timestamp=datetime{timezone=America/Los_Angeles}$ $FUTURE_USE$,$Receive_Time$,$Serial_Number$,SYSTEM,$Content-Threat_Type$,$FUTURE_USE$,$Generated_Time$,$Virtual_System$,$Event_ID$,$Object$,$FUTURE_USE$,$FUTURE_USE$,$Module$,$Severity$,$Description$",
      attributes: {"severity": "CRITICAL", Type: "SYSTEM"}
      halt: true
    },
/*
// specific fields
// extract specific values      
	{
      format: ".*server = $server$[,\\s]"
	},
    {
      format: ".*user = $user$[,\\s]"
	},
    {
      format: ".*, domain = \\<$domain$\\>"
	}
    {
      format: ".*, domain = $domain$"
	},
    {
      format: ".*RPT\\s*=\\s*$rpt=number$"
	},
    {
      format: ".*reason = $reason{regex=[^,]+}$,"
    },
    {
      format: ".*\\%$class$-$severity$-$id$:"
    },
    {
      format: ".*Group [\\(\\[]$group$[\\)\\]]"
    },
    {
       format: ".*User [\\(\\[]$user$[\\)\\]]"
    },
    {
       format: ".*\\%$class$-$severity$-$id$:"
    },
    {
       format: ".*msgid=$messageId$\\)"
    }
    //get timestamp, severity and syslog info 

*/
  ]
}





